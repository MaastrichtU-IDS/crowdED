## app.R ##
library(shinydashboard)
library(shiny)
library(plotly)

ui <- dashboardPage(
  dashboardHeader(title = "Crowdsourcing Task Design Guideline"),
  dashboardSidebar(),
  dashboardBody(
    # Boxes need to be put in a row (or column)
    fluidRow(
  #    box(plotOutput("plot1", height = 250)),
      
      plotlyOutput("plot"),
      
      box(
        title = "Controls",
        sliderInput("slider", "Number of observations:", 0, 1, 50)
      ),
      
      box(
        title = "Controls1",
        sliderInput("slider1", "Number of observations:", 0, 1, 50)
      )
      
      
    )
  )
)

server <- function(input, output) {
  set.seed(122)
  histdata <- rnorm(500)
  
 # output$plot1 <- renderPlot({
#    data <- histdata[seq_len(input$slider)]
 #   hist(data)
    
#  output$plot <- renderPlotly({
 #   plot_ly(mtcars, x = ~mpg, y = ~wt)
   
  output$plot <- renderPlotly({ 
    
    trace1 <- list(
      x = input$slider, #c("0", "0", "0", "0", "0.00934579439252336", "0.00934579439252336", "0.0186915887850467", "0.0280373831775701", "0.0280373831775701", "0.0280373831775701", "0.0280373831775701", "0.0280373831775701", "0.0280373831775701", "0.0280373831775701", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0373831775700935", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0467289719626168", "0.0560747663551402", "0.0560747663551402", "0.0560747663551402", "0.0560747663551402", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0654205607476635", "0.0747663551401869", "0.0841121495327103", "0.0841121495327103", "0.0841121495327103", "0.0841121495327103", "0.0841121495327103", "0.0841121495327103", "0.0934579439252336", "0.0934579439252336", "0.102803738317757", "0.102803738317757", "0.102803738317757", "0.102803738317757", "0.102803738317757", "0.102803738317757", "0.11214953271028", "0.11214953271028", "0.11214953271028", "0.11214953271028", "0.11214953271028", "0.11214953271028", "0.11214953271028", "0.121495327102804", "0.121495327102804", "0.121495327102804", "0.121495327102804", "0.121495327102804", "0.130841121495327", "0.130841121495327", "0.130841121495327", "0.130841121495327", "0.130841121495327", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.14018691588785", "0.149532710280374", "0.149532710280374", "0.149532710280374", "0.158878504672897", "0.168224299065421", "0.177570093457944", "0.186915887850467", "0.196261682242991", "0.205607476635514", "0.214953271028037", "0.224299065420561", "0.233644859813084", "0.242990654205607", "0.252336448598131", "0.261682242990654", "0.271028037383178", "0.280373831775701", "0.289719626168224", "0.299065420560748", "0.308411214953271", "0.317757009345794", "0.327102803738318", "0.336448598130841", "0.345794392523364", "0.355140186915888", "0.364485981308411", "0.373831775700935", "0.383177570093458", "0.392523364485981", "0.401869158878505", "0.411214953271028", "0.420560747663551", "0.429906542056075", "0.439252336448598", "0.439252336448598", "0.448598130841121", "0.457943925233645", "0.467289719626168", "0.476635514018692", "0.476635514018692", "0.485981308411215", "0.495327102803738", "0.504672897196262", "0.514018691588785", "0.514018691588785", "0.514018691588785", "0.523364485981308", "0.532710280373832", "0.542056074766355", "0.551401869158878", "0.560747663551402", "0.560747663551402", "0.560747663551402", "0.570093457943925", "0.579439252336449", "0.588785046728972", "0.588785046728972", "0.598130841121495", "0.607476635514019", "0.607476635514019", "0.616822429906542", "0.626168224299065", "0.635514018691589", "0.635514018691589", "0.644859813084112", "0.654205607476635", "0.663551401869159", "0.672897196261682", "0.682242990654206", "0.691588785046729", "0.700934579439252", "0.710280373831776", "0.719626168224299", "0.728971962616822", "0.738317757009346", "0.747663551401869", "0.747663551401869", "0.757009345794392", "0.766355140186916", "0.775700934579439", "0.785046728971963", "0.794392523364486", "0.803738317757009", "0.803738317757009", "0.813084112149533", "0.822429906542056", "0.831775700934579", "0.841121495327103", "0.850467289719626", "0.85981308411215", "0.869158878504673", "0.878504672897196", "0.88785046728972", "0.897196261682243", "0.906542056074766", "0.91588785046729", "0.925233644859813", "0.934579439252336", "0.94392523364486", "0.953271028037383", "0.962616822429907", "0.97196261682243", "0.981308411214953", "0.990654205607477", "0.990654205607477", "0.990654205607477", "1", "1"), 
      y = input$slider1, #c("0", "0.010752688172043", "0.021505376344086", "0.032258064516129", "0.032258064516129", "0.043010752688172", "0.043010752688172", "0.043010752688172", "0.0537634408602151", "0.0645161290322581", "0.0752688172043011", "0.0860215053763441", "0.0967741935483871", "0.10752688172043", "0.10752688172043", "0.118279569892473", "0.129032258064516", "0.139784946236559", "0.150537634408602", "0.161290322580645", "0.172043010752688", "0.182795698924731", "0.182795698924731", "0.193548387096774", "0.204301075268817", "0.21505376344086", "0.225806451612903", "0.236559139784946", "0.247311827956989", "0.258064516129032", "0.268817204301075", "0.279569892473118", "0.290322580645161", "0.301075268817204", "0.311827956989247", "0.32258064516129", "0.32258064516129", "0.333333333333333", "0.344086021505376", "0.354838709677419", "0.354838709677419", "0.365591397849462", "0.376344086021505", "0.387096774193548", "0.397849462365591", "0.408602150537634", "0.419354838709677", "0.43010752688172", "0.440860215053763", "0.451612903225806", "0.462365591397849", "0.473118279569892", "0.483870967741935", "0.483870967741935", "0.483870967741935", "0.494623655913978", "0.505376344086022", "0.516129032258065", "0.526881720430108", "0.537634408602151", "0.537634408602151", "0.548387096774194", "0.548387096774194", "0.559139784946237", "0.56989247311828", "0.580645161290323", "0.591397849462366", "0.602150537634409", "0.602150537634409", "0.612903225806452", "0.623655913978495", "0.634408602150538", "0.645161290322581", "0.655913978494624", "0.666666666666667", "0.666666666666667", "0.67741935483871", "0.688172043010753", "0.698924731182796", "0.709677419354839", "0.709677419354839", "0.720430107526882", "0.731182795698925", "0.741935483870968", "0.752688172043011", "0.752688172043011", "0.763440860215054", "0.774193548387097", "0.78494623655914", "0.795698924731183", "0.806451612903226", "0.817204301075269", "0.827956989247312", "0.827956989247312", "0.838709677419355", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.849462365591398", "0.860215053763441", "0.860215053763441", "0.860215053763441", "0.860215053763441", "0.860215053763441", "0.870967741935484", "0.870967741935484", "0.870967741935484", "0.870967741935484", "0.870967741935484", "0.881720430107527", "0.89247311827957", "0.89247311827957", "0.89247311827957", "0.89247311827957", "0.89247311827957", "0.89247311827957", "0.903225806451613", "0.913978494623656", "0.913978494623656", "0.913978494623656", "0.913978494623656", "0.924731182795699", "0.924731182795699", "0.924731182795699", "0.935483870967742", "0.935483870967742", "0.935483870967742", "0.935483870967742", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.946236559139785", "0.956989247311828", "0.956989247311828", "0.956989247311828", "0.956989247311828", "0.956989247311828", "0.956989247311828", "0.956989247311828", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.967741935483871", "0.978494623655914", "0.989247311827957", "0.989247311827957", "1"), 
      name = "name",
      type = "area"
    )
    data <- list(trace1)
    # layout <- list(
    #   autosize = TRUE, 
    #   bargap = 0.2, 
    #   bargroupgap = 0, 
    #   barmode = "stack", 
    #   font = list(
    #     color = "#000", 
    #     family = "Arial, sans-serif;", 
    #     size = 12
    #   ), 
    #   height = 872, 
    #   legend = list(
    #     bgcolor = "#fff", 
    #     bordercolor = "#000", 
    #     borderwidth = 1, 
    #     font = list(
    #       color = "", 
    #       family = "", 
    #       size = 0
    #     )
    #   ), 
    #   margin = list(
    #     r = 40, 
    #     t = 60, 
    #     b = 60, 
    #     l = 70, 
    #     pad = 2
    #   ), 
    #   paper_bgcolor = "#fff", 
    #   plot_bgcolor = "#fff", 
    #   title = "ROC Curve", 
    #   titlefont = list(
    #     color = "", 
    #     family = "", 
    #     size = 0
    #   ), 
    #   width = 1279, 
    #   xaxis = list(
    #     autorange = TRUE, 
    #     autotick = TRUE, 
    #     dtick = 0.2, 
    #     gridcolor = "#ddd", 
    #     gridwidth = 1, 
    #     nticks = 0, 
    #     range = c(-0.05, 1.05), 
    #     showgrid = TRUE, 
    #     showticklabels = TRUE, 
    #     tick0 = 0, 
    #     tickcolor = "#000", 
    #     tickfont = list(
    #       color = "", 
    #       family = "", 
    #       size = 0
    #     ), 
    #     ticklen = 5, 
    #     ticks = "outside", 
    #     tickwidth = 1, 
    #     title = "P(True Positive)", 
    #     titlefont = list(
    #       color = "", 
    #       family = "", 
    #       size = 0
    #     ), 
    #     type = "linear", 
    #     zeroline = TRUE, 
    #     zerolinecolor = "#000", 
    #     zerolinewidth = 1
    #   ), 
    #   yaxis = list(
    #     autorange = TRUE, 
    #     autotick = TRUE, 
    #     dtick = 0.2, 
    #     gridcolor = "#ddd", 
    #     gridwidth = 1, 
    #     nticks = 0, 
    #     range = c(-0.05, 1.05), 
    #     showgrid = TRUE, 
    #     showticklabels = TRUE, 
    #     tick0 = 0, 
    #     tickcolor = "#000", 
    #     tickfont = list(
    #       color = "", 
    #       family = "", 
    #       size = 0
    #     ), 
    #     ticklen = 5, 
    #     ticks = "outside", 
    #     tickwidth = 1, 
    #     title = "P(False Positive)", 
    #     titlefont = list(
    #       color = "", 
    #       family = "", 
    #       size = 0
    #     ), 
    #     type = "linear", 
    #     zeroline = TRUE, 
    #     zerolinecolor = "#000", 
    #     zerolinewidth = 1
    #  )
    #)
    p <- plot_ly()
    p <- add_trace(p, x=trace1$x, y=trace1$y, name=trace1$name, type=trace1$type)
    #p <- layout(p, autosize=layout$autosize, bargap=layout$bargap, bargroupgap=layout$bargroupgap, barmode=layout$barmode, font=layout$font, height=layout$height, legend=layout$legend, margin=layout$margin, paper_bgcolor=layout$paper_bgcolor, plot_bgcolor=layout$plot_bgcolor, title=layout$title, titlefont=layout$titlefont, width=layout$width, xaxis=layout$xaxis, yaxis=layout$yaxis)
    
    
  })
    
}

shinyApp(ui, server)